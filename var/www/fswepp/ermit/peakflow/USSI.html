<html>
 <head>
  <title>Peak flow using Curve Number technology</title>
  <script language="JavaScript" type="TEXT/JAVASCRIPT">
   <!--

fixed = false
dummy=1
if (dummy.toFixed) {fixed=true}
// if (fixed) {alert('true')}
winHeight=640
winWidth=1280
h_padding=0;
v_padding=0;

function TransferTcag() {
  document.PeakFlow.Tc.value=document.PeakFlow.Tcag.value
  document.PeakFlow.Tc_.value=document.PeakFlow.Tcag.value
  Calculate_SI()
}

function Calculate_SI() {
   //transfer SI input values to US values
   //if all have values ...
   var Q = document.PeakFlow.Q.value
       if (isNumber(Q)) {
         Q = Q / 25.4
         if (fixed) Q=Q.toFixed(1)
         document.PeakFlow.Q_.value=Q
       }
   var P = document.PeakFlow.P.value
       if (isNumber(P)) {
         P = P / 25.4
         if (fixed) P=P.toFixed(1)
         document.PeakFlow.P_.value=P
       }
   var A = document.PeakFlow.A.value
       if (isNumber(A)) {
         A = A * 2.471				// ha to ac
         if (fixed) A=A.toFixed(1)
         document.PeakFlow.A_.value=A
       }
   var L = document.PeakFlow.L.value
       if (isNumber(L)) {
         L = L * 3.29
         if (fixed) L=L.toFixed(1)
         document.PeakFlow.L_.value=L
       }
   document.PeakFlow.Sg_.value = document.PeakFlow.Sg.value
   document.PeakFlow.Tc_.value = document.PeakFlow.Tc.value
   document.PeakFlow.Fp_.value = document.PeakFlow.Fp.value

   Calc_Tc()
   Estimate_CN()
   Estimate_SurfaceStorage()
   Estimate_RainfallFraction()
   Estimate_qu()
   Calc_q()

   //transfer SI output values to US values

   document.PeakFlow.CN_.value = document.PeakFlow.CN.value
   var S = document.PeakFlow.S.value
       if (isNumber(S)) {
         S = S / 254.
         if (fixed) S=S.toFixed(2)
         document.PeakFlow.S_.value=S
       }
   var Ia = document.PeakFlow.Ia.value
       if (isNumber(Ia)) {
         Ia = Ia / 254.
         if (fixed) Ia=Ia.toFixed(2)
         document.PeakFlow.Ia_.value=Ia
       }
   document.PeakFlow.IaOnP_.value = document.PeakFlow.IaOnP.value
   var qu = document.PeakFlow.qu.value
       if (isNumber(qu)) {
         qu = qu * 1
         if (fixed) qu=qu.toFixed(2)
         document.PeakFlow.qu_.value=qu
       }
   var q = document.PeakFlow.q.value
       if (isNumber(q)) {
         q = q * 35.31				// cubic meters per second to cubic feet per second
         if (fixed) q=q.toFixed(2)
         document.PeakFlow.q_.value=q
       }
}

function Calculate_US() {
   //transfer US input values to SI values
   //if all have values ...
   var Q_ = document.PeakFlow.Q_.value
       if (isNumber(Q_)) {
         Q_ = Q_ * 25.4
         if (fixed) Q_=Q_.toFixed(1)
         document.PeakFlow.Q.value=Q_
       }
   var P_ = document.PeakFlow.P_.value
       if (isNumber(P_)) {
         P_ = P_ * 25.4
         if (fixed) P_=P_.toFixed(1)
         document.PeakFlow.P.value=P_
       }
   var A_ = document.PeakFlow.A_.value
       if (isNumber(A_)) {
         A_ = A_ / 2.471				// ha to ac
         if (fixed) A_=A_.toFixed(1)
         document.PeakFlow.A.value=A_
       }
   var L_ = document.PeakFlow.L_.value
       if (isNumber(L_)) {
         L_ = L_ / 3.29
         if (fixed) L_=L_.toFixed(1)
         document.PeakFlow.L.value=L_
       }
   document.PeakFlow.Sg.value = document.PeakFlow.Sg_.value
   document.PeakFlow.Tc.value = document.PeakFlow.Tc_.value
   document.PeakFlow.Fp.value = document.PeakFlow.Fp_.value

   Calc_Tc()
   Estimate_CN()
   Estimate_SurfaceStorage()
   Estimate_RainfallFraction()
   Estimate_qu()
   Calc_q()

   //transfer SI output values to US values

   document.PeakFlow.CN_.value = document.PeakFlow.CN.value
   var S = document.PeakFlow.S.value
       if (isNumber(S)) {
         S = S / 254.
         if (fixed) S=S.toFixed(2)
         document.PeakFlow.S_.value=S
       }
   var Ia = document.PeakFlow.Ia.value
       if (isNumber(Ia)) {
         Ia = Ia / 254.
         if (fixed) Ia=Ia.toFixed(2)
         document.PeakFlow.Ia_.value=Ia
       }
   document.PeakFlow.IaOnP_.value = document.PeakFlow.IaOnP.value
   var qu = document.PeakFlow.qu.value
       if (isNumber(qu)) {
         qu = qu * 1
         if (fixed) qu=qu.toFixed(2)
         document.PeakFlow.qu_.value=qu
       }
   var q = document.PeakFlow.q.value
       if (isNumber(q)) {
         q = q * 35.31				// cubic meters per second to cubic feet per second
         if (fixed) q=q.toFixed(2)
         document.PeakFlow.q_.value=q
       }
}

function Calc_Tc() {
  var Sg = document.PeakFlow.Sg.value		// Sg = average watershed gradient (m/m)
  var CN = document.PeakFlow.CN.value		// CN = runoff curve number
  var L  = document.PeakFlow.L.value		// L = longest flow length (m)
//  alert(Sg)
  if (isNumber(Sg) && isNumber(CN) && isNumber(L)) {
    var num = Math.pow((1000/CN)-9,0.7)
    var den = 4407 * Math.pow(Sg,0.5)
    Tc = Math.pow(L,0.8) * num / den		// calculate Tc time of concentration (h) from equation 5.12
  } else {
    Tc = ''
  }
  document.PeakFlow.Tcag.value = Tc		// alert(Tc)
  if (fixed) {
    document.PeakFlow.Tcag.value = Tc.toFixed(2)
  }
  else {}
}

function Estimate_SurfaceStorage() {
  var CN = document.PeakFlow.CN.value		// CN = runoff curve number
  document.PeakFlow.S.value = ''
  document.PeakFlow.Ia.value = ''    
  if (isNumber(CN)) {
    S  = (25400/CN)-254			// S  = Surface storage
    Ia = 0.2 * S
    document.PeakFlow.S.value = S			// alert (S)
    document.PeakFlow.Ia.value = Ia
    if (fixed) {
      document.PeakFlow.S.value = S.toFixed(0)
      document.PeakFlow.Ia.value = Ia.toFixed(0)
    }
  }
}

function Estimate_CN() {			// From Iowa Stormwater Management Manual 2C-5 NRCS TR-55 Methodology
  var Q = document.PeakFlow.Q.value		// Q = runoff depth from a 24-h storm of the desired period (mm)
  var P = document.PeakFlow.P.value 		// P  = 24-h rainfall with a return period equal to the return period of the peak flow (mm)
  document.PeakFlow.CN.value = ''
  if (isNumber(Q) && isNumber(P)) {
    CN = 25400/((0.4*P+0.8*Q-Math.pow(Math.pow(0.4*P+0.8*Q,2)-0.16*(P*P-Q*P),0.5))/0.08+254)
    document.PeakFlow.CN.value = CN 
    if (fixed) {
      document.PeakFlow.CN.value = CN.toFixed(0)
    }
  }
}

function Estimate_RainfallFraction() {
  var Ia = document.PeakFlow.Ia.value		// Ia = runoff curve number
  var P  = document.PeakFlow.P.value 		// P  = 24-h rainfall with a return period equal to the return period of the peak flow
  IaOnP=''
  if (isNumber(Ia) && isNumber(P)) {
    IaOnP = Ia/P
    document.PeakFlow.IaOnP.value = IaOnP		// alert (IaOnP)
    if (fixed) {
      document.PeakFlow.IaOnP.value = IaOnP.toFixed(2)
    }
  }
}

function Estimate_qu() {			// From figure 5.4
//  var Tc    = document.PeakFlow.Tc.value
//  var IaOnP = document.PeakFlow.IaOnP.value
  var tc  = document.PeakFlow.Tc.value
  var iap = document.PeakFlow.IaOnP.value
//tc = Tc
//iap = IaOnP

// use upper and lower curve on Ia/P instead of dropping off   2010.07.15

// alert('Tc: '+tc)
// alert('Ia/P: '+iap)

  qu = ''
  if (isNumber(tc) && isNumber(iap)) {
    if (tc < .1) {qu=''}
    else if (tc <= .2) {
//      if (iap < .10) {}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.1,.2,4.60,4.10,3.44,3.00)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.1,.2,4.10,3.80,3.00,2.28)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.1,.2,3.80,3.50,2.28,2.47)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.1,.2,3.50,3.00,2.47,2.90)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.1,.2,3.00,2.28,2.90,1.60)}
      else {qu=twodinterp(iap,tc,.45,.50,.1,.2,3.00,2.28,2.90,1.60)}
    }
    else if (tc <= .4) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.2,.4,3.44,3.00,2.55,2.10)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.2,.4,3.00,2.82,2.10,1.88)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.2,.4,2.82,2.47,1.88,1.70)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.2,.4,2.47,2.90,1.70,1.42)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.2,.4,2.90,1.60,1.42,1.15)}
      else {qu=twodinterp(iap,tc,.45,.50,.2,.4,2.90,1.60,1.42,1.15)}
    }
    else if (tc <= .6) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.4,.6,2.55,2.10,1.95,1.67)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.4,.6,2.10,1.88,1.67,1.51)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.4,.6,1.88,1.70,1.51,1.38)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.4,.6,1.70,1.42,1.38,1.15)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.4,.6,1.42,1.15,1.15,0.95)}
      else {qu=twodinterp(iap,tc,.45,.50,.4,.6,1.42,1.15,1.15,0.95)}
    }
    else if (tc <= .8) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.6,.8,1.95,1.67,1.70,1.49)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.6,.8,1.67,1.51,1.49,1.33)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.6,.8,1.51,1.38,1.33,1.19)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.6,.8,1.38,1.15,1.19,0.98)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.6,.8,1.15,0.95,0.98,0.79)}
      else {qu=twodinterp(iap,tc,.45,.50,.6,.8,1.15,0.95,0.98,0.79)}
    }
    else if (tc <= 1) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.8,1,1.70,1.49,1.50,1.35)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.8,1,1.49,1.33,1.35,1.20)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.8,1,1.33,1.19,1.20,1.03)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.8,1,1.19,0.98,1.03,0.88)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.8,1,0.98,0.79,0.88,0.70)}
      else {qu=twodinterp(iap,tc,.45,.50,.8,1,0.98,0.79,0.88,0.70)}
    }
    else if (tc <= 2) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,1,2,1.50,1.35,1.00,0.80)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,1,2,1.35,1.20,0.80,0.75)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,1,2,1.20,1.03,0.75,0.66)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,1,2,1.03,0.88,0.66,0.56)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,1,2,0.88,0.70,0.56,0.48)}
      else {qu=twodinterp(iap,tc,.45,.50,1,2,0.88,0.70,0.56,0.48)}
    }
    else if (tc <= 4) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,2,4,1.00,0.80,0.58,0.47)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,2,4,0.80,0.75,0.47,0.45)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,2,4,0.75,0.66,0.45,0.43)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,2,4,0.66,0.56,0.43,0.38)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,2,4,0.56,0.48,0.38,0.35)}
      else {qu=twodinterp(iap,tc,.45,.50,2,4,0.56,0.48,0.38,0.35)}
    }
    else if (tc <= 6) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,4,6,0.58,0.47,0.42,0.36)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,4,6,0.47,0.45,0.36,0.35)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,4,6,0.45,0.425,0.35,0.33)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,4,6,0.425,0.38,0.33,0.30)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,4,6,0.38,0.35,0.30,0.28)}
      else {qu=twodinterp(iap,tc,.45,.50,4,6,0.38,0.35,0.30,0.28)}
    }
    else if (tc <= 8) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,6,8,0.42,0.36,0.325,0.28)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,6,8,0.36,0.35,0.28,0.27)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,6,8,0.35,0.33,0.27,0.26)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,6,8,0.33,0.30,0.26,0.25)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,6,8,0.30,0.28,0.25,0.24)}
      else {qu=twodinterp(iap,tc,.45,.50,6,8,0.30,0.28,0.25,0.24)}
    }
    else if (tc <= 10) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,8,10,0.325,0.275,0.255,0.235)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,8,10,0.275,0.27,0.235,0.23)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,8,10,0.27,0.26,0.23,0.225)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,8,10,0.26,0.25,0.225,0.22)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,8,10,0.25,0.24,0.22,0.215)}
      else {qu=twodinterp(iap,tc,.45,.50,8,10,0.25,0.24,0.22,0.215)}
    }
    else {qu=''}		// if (tc <= 10) ...
  }
// alert ('qu: '+qu)
    document.PeakFlow.qu.value = qu
    if (fixed) {
      document.PeakFlow.qu.value = qu.toFixed(2)
    }
}

function Calc_q() {
  var qu = document.PeakFlow.qu.value/1000	// qu = unit peak flow rate (cu m/s per ha per mm of runoff)
  var A  = document.PeakFlow.A.value		// A  = watershed area (ha)
  var Q  = document.PeakFlow.Q.value		// Q = runoff depth from a 24-h storm of the desired period (mm)
  var Fp = document.PeakFlow.Fp.value		// pond and swamp adjustment factor
//  var Fp = 1					// pond and swamp adjustment factor
  q = ''
  if (isNumber(qu) && isNumber(A) && isNumber(Q)) {
    q  = qu * A * Q * Fp			// peak runoff rate (cu m/s); equation 5.11
  }
  document.PeakFlow.q.value = q			// alert(q)
  if (fixed) {
    document.PeakFlow.q.value = q.toFixed(2)
  }
}

function twodinterp(x,y,xl,xh,yl,yh,zll,zlr,zul,zur) {
   var xrat = (x-xl)/(xh-xl)
   var yrat = (y-yl)/(yh-yl)
   var yyl = zll+(zul-zll)*yrat
   var yyr = zlr+(zur-zlr)*yrat
   var xx = yyl+(yyr-yyl)*xrat
   return xx
}

function isNumber(inputVal) {		//From JavaScript Handbook (Goodman) p. 374.
  if (inputVal == '') {return false}
  oneDecimal = false
  inputStr = "" + (inputVal+0)
  for (var i = 0; i < inputStr.length; i++) {
    var oneChar = inputStr.charAt(i)
    if (i == 0 && oneChar == "-") {
      continue
    }
    if (oneChar == "." && !oneDecimal) {
      oneDecimal = true
      continue
    }
    if (oneChar < "0" || oneChar > "9") {
      return false
    }
  }
  return true
}

function example() {
  document.PeakFlow.desc.value='Severe wildfire in a watershed in the Mica Creek Experimental Forest, Northern Idaho'
  document.PeakFlow.Q.value=26.5
  document.PeakFlow.P.value=49.3
  document.PeakFlow.L.value=2572
  document.PeakFlow.A.value=575
  document.PeakFlow.Sg.value=0.133
  document.PeakFlow.Tc.value=10
  document.PeakFlow.CN.value=90
  document.PeakFlow.Fp.value=1
  Calculate_SI()
}

function hideBubble(e) {
		 var bubble = document.getElementById('bubble');
		 b = bubble.style;
		 b.visibility='hidden';
}

function is_right_available(box,e) {
		 if ((box.clientWidth+e.clientX+h_padding)>=winWidth){
		   return false; // not available
		 }
		 return true;
}

function is_top_available(box,e) {
		 if ((e.clientY-box.clientHeight-v_padding) < 0){
		   return false;
		 }
		 return true;
}

function is_bot_available(box,e) {
		 if ((e.clientY+box.clientHeight+v_padding) > winHeight){
		   return false;
		 }
		 return true;
}

function is_left_available(box,e) {
		 if ((e.clientX-box.clientWidth-h_padding)<0){
          return false;
		 }
		 return true;
}

function  showBubble(e, str, area) {
		 var relTarg;
		 var bubble = document.getElementById('bubble');
//		 var bubble = document.getElementById(area);
		 if (!e) var e = window.event;
		 if (e.relatedTarget) relTarg = e.relatedTarget;
		 else if (e.fromElement) relTarg = e.fromElement;

  var posRefX, posRefY = 0; 
  posRefX= ((e.pageX && !e.clientX) ? e.pageX : e.clientX + document.body.scrollLeft);
  posRefY= ((e.pageY && !e.clientY) ? e.pagey : e.clientY + document.body.scrollTop);

		 b = bubble.style

		 //str=str+"hello: "+bubble.clientWidth;
		 document.getElementById('bubble').innerHTML=str;
//		 document.getElementById(area).innerHTML=str;

		 var mytop   = is_top_available(bubble,e);
		 var mybot   = is_bot_available(bubble, e);
		 var myright = is_right_available(bubble,e);
		 var myleft  = is_left_available(bubble,e);

		 if (mytop)
		 {
		 		 // move to the top
		 		 //b.top=e.clientY-bubble.clientHeight-v_padding;
		 		 bubble.ypos=posRefY-bubble.clientHeight-v_padding;
		 		 //document.write(bubble.ypos);
		 		 //alert(bubble.xpos);
		 }

		 if (myright)
		 {
		 		 // move to the right
		 		 //b.left=e.clientX+h_padding;//+bubble.clientWidth;
		 		 bubble.xpos=posRefX+h_padding;
		 }

		 if (myleft)
		 {
		 		 // move to the left
		 		 //b.left=e.clientX-bubble.clientWidth-h_padding ;
		 		 bubble.xpos=posRefX-bubble.clientWidth-h_padding ;
		 }

		 if (mybot)
		 {
		 		 // move to the bottom
		 		 //b.top=e.clientY+v_padding;
		 		 bubble.ypos=posRefY+v_padding;
		 }

		 b.visibility='visible';
//		 moveBox()
		 //moveBox(bubble);
//		 window.setTimeout("moveBox()", 10);
}

   -->
  </script>
 </head>
 <body link=green vlink=green alink=crimson>
  <font face="comic sans, trebuchet, tahoma" size=-1>
  <h3>Estimated peak flow using Curve Number technology</h3>
  <form name="PeakFlow">

   <table border=1 cellpadding=2>
    <tr>
     <td align=right bgcolor=lightblue>
      Description
     </td>
     <td colspan=4 bgcolor=lightblue>
      <input type=text name="desc" size=100>
     </td>
    </tr>
<!--      RUNOFF    -->
    <tr>
     <td align=right bgcolor=lightgreen
       onmouseover="showBubble(event,'<b>Runoff from ERMiT run.</b>  From the information given in the ERMiT Return Period/Runoff table, it is possible to determine a number of attributes about the nature of the runoff.  This example is from an ERMiT run for a severe wildfire using a hillside in a watershed in the Mica Creek Experimental Forest in Northern Idaho. The largest predicted daily runoff event from 100 years of stochastic climate on a severely burned hillslope was 88&nbsp;mm from only 10.1&nbsp;mm of precipitation on March&nbsp;1 in year&nbsp;97. As the runoff is greater than the precipitation, and it occurred in March, the user can assume that this was a rain-on-snow event, and a melting snowpack contributed more water to the runoff than was in the rainfall.<br><br>If it is likely that the runoff event of concern occurred during a time when the soil was likely saturated, as it is during most rain on snow or snow melt events, the user may want to increase the runoff amount to account for lateral flow.  This can be estimated from the WEPP Windows water file for a run for the same climate and hillslope, with specifying a soil and cover to match the fire severity condition, and noting the lateral flow on the date of concern.  Another approach is to simply increase the runoff amount by about 20 percent, a typical average value in a burned watershed.<br><br><img src=ERMiTexampleRun.gif>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Runoff from ERMiT, <b>Q</b>&nbsp;</font></td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1><input type=text size=10 name=Q value='' onchange="Calculate_SI()">
     &nbsp;mm</font></td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Q_ value='' onchange="Calculate_US()">
     &nbsp;in</font></td>
    </tr>
<!--      24-HOUR RAINFALL    -->
    <tr>
     <td align=right bgcolor=lightgreen
       onmouseover="showBubble(event,'<b>24-h rainfall</b> from ERMiT run. The precipitation value is often chosen to be a 6-hr or 24-hr design storm that occur once every 10 or 20 years. If the runoff is from snowmelt, so that the runoff is greater than the precipitation, then it is recommended that a value for precipitation about twice the runoff amount be entered in the precipitation line.<br><br>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>24-h rainfall from ERMiT, <b>P</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=P size=10 value='' onchange="Calculate_SI()">
     &nbsp;mm</font></td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=P_ value='' onchange="Calculate_US()">
     &nbsp;in</font></td>
    </tr>
<!--      WATERSHED UPPER AREA    -->
    <tr>
     <td align=right bgcolor=lightblue
      onmouseover="showBubble(event,'<b>Watershed area</b> above the structure of interest. In the TR-55 method employed in this estimator, the peak flow rate is in direct proportion to the watershed area.  Area can be estimated from maps with a planimeter or grid method.  There are numerous GIS methods for estimating watershed area.  The GeoWEPP ArcGIS wizard may be particularly beneficial because it can supplement the analysis procedure by estimating watershed area, provide sets of slope length and steepness values to enter into the ERMiT tool when used with the RMRS GeoWEPPer tool, or provide return period estimates of runoff that include lateral flow to use directly with the peak flow estimator.<br><br>', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Watershed area, <b>A</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=A size=10 value='' onchange="Calculate_SI()">
      &nbsp;ha</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=A_ value='' onchange="Calculate_US()">
     &nbsp;ac</font></td>
    </tr>
<!--      WATERSHED LENGTH    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'<b>Watershed flow length</b> is the horizontal distance from the top of the watershed to the structure of interest.  This distance should follow the flow path, and will not necessarily be a straight line.  A GIS or a ruler and a scaled map will provide this estimate.<br><br>L ~ 110 * A<sup>0.6</sup> for small watersheds', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>
        Watershed flow length, <b>L</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=L size=10 value='' onchange="Calculate_SI()">
      &nbsp;m</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=L_ value='' onchange="Calculate_US()">
     &nbsp;ft</font></td>
    </tr>
<!--      AVERAGE WATERSHED GRADIENT    -->
    <tr>
     <td align=right bgcolor=lightblue
      onmouseover="showBubble(event,'<b>Average watershed gradient</b> can be estimated by dividing the difference in elevation at the top of the watershed and the elevation of the structure of interest by the distance between the two.<br><br>The average steepness of a watershed is estimated by measuring the flow length <i>L</i> from the highest point in the watershed to the point of interest downstream.  Traditional mapping methods with a ruler or scale can be used, and a number of GIS methods are now available.  The difference between the elevation at the highest point in the watershed and the watershed outlet is divided by the flow length to estimate an average watershed gradient <i>Sg</i>.<br><br>', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Avg watershed gradient, <b>Sg</b>&nbsp;</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=Sg size=10 value='' onchange="Calculate_SI()">
      &nbsp;m/m</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name='Sg_' value='' onchange="Calculate_US()">
     &nbsp;ft/ft</font></td>
    </tr>
<!--      TIME OF CONCENTRATION    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'<b>Time of concentration.</b> There are two options provided on this screen for this value. The default value is 10 hours, as this is the maximum value that can be used in the regression equation to predict peak flow.  This is the recommended value unless the watershed has a gradient less than 0.01 m/m (ft/ft) so that lateral flow is minimal, or the climate is dominated by high intensity summer storms on dry soils as may occur in the Southwest U.S.  For flat watersheds or high intensity storms on dry soils, a <i>tc</i> value is calculated by a regression equation based on the watershed length, slope steepness, and curve number (<i>CN</i>) and is shown in the right hand column, along with the regression equation.<br><br> The TR-55 approach estimates a property called the time of concentration (<i>tc</i>) for a watershed. The <i>tc</i> is the theoretical time it takes a drop of rainwater to travel from the top of the watershed to the watershed outlet.  It can be as little as ten minutes, to several hours, depending on the size of the watershed.  It is generally estimated with surface and channel velocity equations, or regression equations that are a function of watershed length and steepness.  Watersheds with longer times of concentration will have lower peak flow rates for the same amount of total runoff.<br><br>Average watershed gradient can be used in a regression equation to estimate the time of concentration <i>tc</i>. There are numerous other methods for estimating the time of concentration.  One common method is to estimate time of concentration by estimating the time it takes water to travel overland along the hill from the highest point in the watershed, and add to that the time it takes the water to travel through the stream network to the point of interest.<br><br>Tc ~ (L<sup>0.8</sup>) * ([1000/CN]-9)<sup>0.7</sup> / (4407 * Sg<sup>0.5</sup>) h for ag', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Time of concentration, <b>Tc</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=Tc size=10 value='10' onchange="Calculate_SI()">
       &nbsp;h</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Tc_ value='' onchange="Calculate_US()">
     &nbsp;h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Tc ~ <input type=text size = 5 readonly name=Tcag onclick=TransferTcag()> h (for ag)</font></td>
    </tr>
<!--      PONDING FACTOR Fp    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'<i>Fp</i> is a <b>ponding adjustment factor</b>. <table><tr><th><font size=1>Percentage of pond/<br>swamp area</th><th><font size=1><i>Fp</i></th></tr><tr><td><font size=1>0.0</td><td><font size=1>1.00</td></tr><tr><td><font size=1>0.2</td><td><font size=1>0.97</td></tr><tr><td><font size=1>1.0</td><td><font size=1>0.87</td></tr><tr><td><font size=1>3.0</td><td><font size=1>0.75</td></tr><tr><td><font size=1>5.0</td><td><font size=1>0.72</td></tr></table>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Ponding adjustment factor, <b>Fp</b>&nbsp;</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name="Fp" size=10 value='1' onchange="Calculate_SI()"></font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Fp_ value=1 onchange="Calculate_US()">
     &nbsp;</font></td>
    </tr>
<!--      CURVE NUMBER    -->
    <tr>
     <td align=right
       onmouseover="showBubble(event,'<b>Curve number.</b> The curve number is based on the runoff and precipitation numbers entered on lines 1 and 2.  This number is likely larger than generally recommended for forests.<br><br>CN ~ 25400/([0.4*P+0.8*Q-([0.4*P+0.8*Q]<sup>2</sup>-0.16*[P*P-Q*P])<sup>0.5</sup>]/0.08+254)', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Curve number, <b>CN</b>&nbsp;</font></td>
     <td colspan=2>
      <font face="comic sans, trebuchet, tahoma" size=-1>
       <script> document.write('<input type=text name=CN size=10 value="" onchange="Calculate_SI()">')</script>
      </font>
      &nbsp;
     </td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=CN_ value='' onchange="Calculate_US()">
     &nbsp;</font></td>
    </tr>
<!--      SURFACE STORAGE    -->
    <tr>
     <td align=right
       onmouseover="showBubble(event,'The curve number technology assumes that there is a fraction of precipitation that is stored on the surface (<i>S</i>).  This <b>surface storage</b> is estimated from the curve number.<br><br>S ~ (25400/CN)-254', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Surface storage,
      <b><a title="S ~ (25400/CN)-254">S'</a></b>&nbsp;</font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=S size=10 value='' readonly>
       &nbsp;mm</font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=S_ value='' onchange="Calculate_SI()" readonly>
     &nbsp;in</font></td>
    </tr>
<!--      INITIAL ABSTRACTION    -->
    <tr>
     <td align=right
       onmouseover="showBubble(event,'Part of the surface storage <i>S</i> is assumed to be the <b>initial abstraction</b> (<i>Ia</i>).<br><br>Ia = 0.2 * S', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Initial abstraction, <b>Ia</b>&nbsp;</font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=Ia size=10 value='' readonly>
      &nbsp;mm</font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Ia_ value='' onchange="Calculate_US()" readonly>
     &nbsp;in</font></td>
    </tr>
<!--      Ia/P    -->
    <tr>
     <td align=right
       onmouseover="showBubble(event,'Ia/P ...<br><br>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1><b>Ia/P</b>&nbsp;</font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name="IaOnP" size=10 value='' readonly></font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=IaOnP_ value='' onchange="Calculate_SI()" readonly>
     &nbsp;</font></td>
    </tr>
<!--      UNIT PEAK FLOW RATE    -->
    <tr>
     <td align=right
       onmouseover="showBubble(event,'The unit peak flow rate <i>qu</i> is estimated from the time of concentration <i>tc</i> and the ratio of the initial abstraction <i>Ia</i> to the precipitation amount <i>P</i>.<br><br>qu = f(Tc, Ia/P); 0.1 &lt;= Ia/P &lt;= 0.5; 0.1 &lt;= Tc &lt;= 10<br><br><img src=fangmeier.gif>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Unit peak flow rate, <b>qu</b></a>&nbsp;</font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=qu size=10 value='' readonly>
       &nbsp;m<sup>3</sup>/s per ha-mm x 10<sup>-3</sup></font></td>
     <td colspan=2><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=qu_ value='' onchange="Calculate_US()" readonly>
      &nbsp;ft<sup>3</sup>/s per acre-in x 10<sup>-3</sup></font></td>
    </tr>
<!--      ESTIMATED PEAK FLOW    -->
    <tr>
     <td align=right bgcolor=gold
       onmouseover="showBubble(event,'The <b>estimated peak flow rate</b> is the product of the unit peak flow rate, watershed area, runoff depth, and a ponding adjustment factor.  This value is intended to be used as a guide when designing structures in channels downstream from areas of forested watersheds that have been burned.<br><br>q = qu * A * Q * Fp', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Estimated peak flow rate, <b>q</b>&nbsp;</font><br><font size=1>use <a href="javascript:example()">Mica Creek example</a>&nbsp;|&nbsp;<a href="javascript:document.forms.PeakFlow.reset()">clear</a></td>
     <td bgcolor=gold><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=q size=10 value='' readonly>
       &nbsp;m<sup>3</sup>/s</font></td>
     <td align=right bgcolor=lightgreen><a onClick="Calculate_SI()"><img src="go.gif"></a></td>
     <td colspan=2 bgcolor=gold><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=q_ value='' onchange="Calculate_US()" readonly>
      &nbsp;ft<sup>3</sup>/s</font></td>
    </tr>
   </table>
   <br>

   <blockquote>
    <span id="bubble"></span>
   </blockquote>
  </form>

  See <a href="http://forest.moscowfsl.wsu.edu/BAERTOOLS/ROADTRT/Peakflow/CN/supplement.html#CNGuideline" target="_o">Use of Post-Fire CNs by BAER Specialists</a>.

 <br><br>
   <font size=-2>

   Curve Number for Woods

<table border=1 width=50%>
 <tr>
  <th colspan=3><font size=-2>Hydrologic condition</font></th>
  <th rowspan=2><font size=-2>Hydrologic soil condition</font></th>
 </tr>
 <tr><th><font size=-2>Poor</font></th><th><font size=-2>Fair</font></th><th><font size=-2>Good</font></th></tr>
 <tr>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=45" title="click to transfer">45</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=36" title="click to transfer">36</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=30" title="click to transfer">30</a></font></th>
  <td><font size=-2><b>Soils have a low runoff potential</b> due to high infiltration rates. These soils consist primarily of deep, well-drained sands and gravels</font></td>
 </tr>
 <tr>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=66" title="click to transfer">66</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=60" title="click to transfer">60</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=55" title="click to transfer">55</a></font></th>
  <td><font size=-2><b>Soils have a moderately low runoff potential</b> due to moderate infiltration rates. These soils consist primarily of moderately deep to deep, moderately well- to well-drained soils with moderately fine to moderately coarse textures.</font></td>
 </tr>
 <tr>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=77" title="click to transfer">77</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=73" title="click to transfer">73</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=70" title="click to transfer">70</a></font></th>
  <td><font size=-2><b>Soils have a moderately high runoff potential</b> due to slow infiltration rates. These soils consist primarily of soils in which a layer exists near the surface that impedes the downward movement of water or soils with moderately fine to fine texture.</font></td>
 </tr>
 <tr>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=83" title="click to transfer">83</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=79" title="click to transfer">79</a></font></th>
  <th><font size=-2><a onClick="javascript:document.PeakFlow.CN.value=77" title="click to transfer">77</a></font></th>
  <td><font size=-2><b>Soils have a high runoff potential</b> due to very slow infiltration rates. These soils consist primarily of clays with high swelling potential, soils with permanently high water tables, soils with a clay pan or clay layer at or near the surface, and shallow soils over nearly impervious parent material.</font></td>
 </tr>
 <tr>
  <td colspan=4><font size=-2>
   <b>Poor:</b> forest litter, small trees, and brush are destroyed by heavy grazing or regular burning.<br>
   <b>Fair:</b> woods are grazed, but not burned, and some forest litter covers the soil.<br>
   <b>Good:</b> woods are protected from grazing, and litter and brush adequately cover the soil.</font>
  </td>
 </tr>
 <tr>

  <td colspan=4><font size=-2>
   From: Iowa Stormwater Management Manual 2C-5 NRCS TR-55 Methodology. Version 2, December 2008. Table 4, p.&nbsp;9.<br>
   http://www.ctre.iastate.edu/PUBS/stormwater/documents/2C-5NRCSTR-55Methodology.pdf, eg<br>
   (from Urban Hydrology for Small Watersheds, SCS 1986)</font>

  </td>
 </tr>

</table>


 <br>
 Follow TR-55 method in Fangmeier et al.
 <ol>

  <li>Run ERMiT for climate and hillslope typical of watershed.</li>
  <li>Note the return period runoff volume from first ERMiT table.</li>
  <li>Estimate the peak runoff rate from the runoff volume using the TR-55 method.</li>

 </ol>

 Changing the length and steepness of the hillslope is unlikely to change the predicted runoff amount.
 It will make a bit difference in erosion.
 <br><br>
 TR-55 method to predict peak runoff from total storm runoff:  
 (From Fangmeier, D.D., W.J. Elliot, S.R. Workman, R.L. Huffman and G.O. Schwab.  2006.
 Soil and Water Conservation Engineering, Fifth Edition.  Clifton Park, NJ:  Thompson Delmar Learning. 95-97).
 <br><br>

 5.16-TR55 Method For Estimating Peak Runoff Rate
 <br><br>
 The SCS-TR55 method has been widely used to estimate peak runoff rates from small rural and urban watersheds (SCS, 1986).
 This method of estimating peak runoff rate is applicable to watersheds that are smaller than 900 ha and
 with average slopes greater than 0.5 percent with one main channel or two tributaries with nearly the same
 time of concentration. 
 <br><br>
 The curves in Fig. 5.4 apply only for the SCS Type II rainfall distribution,
 which is applicable for the unshaded areas of the U.S. shown in Fig. 5.5.
   </font>

<hr>
Citation:<br>
Elliot, William J.; Hall, David E. 2010. Estimated Peak Flow Using Curve Numbers.
Ver. 2010.08.03.
Moscow, ID: U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station. 
Online at &lt;http://forest.moscowfsl.wsu.edu/fswepp/ermit/peakflow&gt;.
  </font>
 </body>
</html>
