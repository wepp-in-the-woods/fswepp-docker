<html>
 <head>
  <title>FS Peak Flow Calculator -- Estimated peak flow for burned areas using Curve Number technology</title>
  <style type="text/css">
   <!--
    P.Reference {
        margin-top:0pt;
        margin-left:.3in;
        text-indent:-.3in;
    }
   -->
  </style>
  <script language="JavaScript" type="TEXT/JAVASCRIPT">
   <!--

//
// Peak flow using Curve Number technology
// USDA Forest Service, Rocky Mountain Research Station, Moscow, ID
// forest.moscowfsl.wsu.edu/ermit/peakflow/
//

version = '2010.10.28';
fixed = false
dummy=1
if (dummy.toFixed) {fixed=true}
// if (fixed) {alert('true')}
winHeight=640
winWidth=1280
h_padding=0;
v_padding=0;

  function popuphistory() {
    height=500;
    width=660;
    pophistory = window.open('','pophistory','toolbar=no,location=no,status=no,directories=no,menubar=no,scrollbars=yes,resizable=yes,width='+width+',height='+height);
    pophistory.document.writeln('<html>')
    pophistory.document.writeln(' <head>')
    pophistory.document.writeln('  <title>FS Peak Flow Calculator version history</title>')
    pophistory.document.writeln(' </head>')
    pophistory.document.writeln(' <body bgcolor=white>')
    pophistory.document.writeln('  <font face="trebuchet, tahoma, arial, helvetica, sans serif">')
    pophistory.document.writeln('  <center>')
    pophistory.document.writeln('   <h4>FS Peak Flow Calculator version history</h4>')
    pophistory.document.writeln('   <p>')
    pophistory.document.writeln('   <table border=0 cellpadding=10>')
    pophistory.document.writeln('    <tr>')
    pophistory.document.writeln('     <th bgcolor=lightblue>Version</th>')
    pophistory.document.writeln('     <th bgcolor=lightblue>Comments</th>')
    pophistory.document.writeln('    </tr>')
    pophistory.document.writeln('    <tr>')
    pophistory.document.writeln('     <th valign=top bgcolor=lightblue>2010.10.28</th>')
    pophistory.document.writeln('     <td>Beta release</td>')
    pophistory.document.writeln('    </tr>')
    pophistory.document.writeln('   </table>')
    pophistory.document.writeln('   </font>')
    pophistory.document.writeln('  </center>')
    pophistory.document.writeln(' </body>')
    pophistory.document.writeln('</html>')
    pophistory.document.close()
    pophistory.focus()
  }

function TransferTcag() {
  document.PeakFlow.Tc.value=document.PeakFlow.Tcag.value
  document.PeakFlow.Tc_.value=document.PeakFlow.Tcag.value
  Calculate_SI()
}

function TransferCN() {
  document.PeakFlow.CN.value=document.PeakFlow.CNforest.value
  document.PeakFlow.CN_.value=document.PeakFlow.CNforest.value
  Calculate_SI()
}

function validate() {
  ClearResults()
  if (!isNumber(document.PeakFlow.Q.value))  {document.PeakFlow.Q.value = ''; document.PeakFlow.Q_.value = ''}
  if (!isNumber(document.PeakFlow.P.value))  {document.PeakFlow.P.value = ''; document.PeakFlow.P_.value = ''}
  if (!isNumber(document.PeakFlow.A.value))  {document.PeakFlow.A.value = ''; document.PeakFlow.A_.value = ''}
  if (!isNumber(document.PeakFlow.L.value))  {document.PeakFlow.L.value = ''; document.PeakFlow.L_.value = ''}
  if (!isNumber(document.PeakFlow.Sg.value)) {document.PeakFlow.Sg.value =''; document.PeakFlow.Sg_.value =''}
  if (!isNumber(document.PeakFlow.Tc.value)) {document.PeakFlow.Tc.value =''; document.PeakFlow.Tc_.value =''}
  if (!isNumber(document.PeakFlow.CN.value)) {document.PeakFlow.CN.value =''; document.PeakFlow.CN_.value =''}
  if (!isNumber(document.PeakFlow.Fp.value)) {document.PeakFlow.Fp.value =''; document.PeakFlow.Fp_.value =''}

  if (document.PeakFlow.Q.value <= 0)   {document.PeakFlow.Q.value = '';  document.PeakFlow.Q_.value = ''}
  if (document.PeakFlow.P.value <= 0)   {document.PeakFlow.P.value = '';  document.PeakFlow.P_.value = ''}
  if (document.PeakFlow.A.value <= 0)   {document.PeakFlow.A.value = '';  document.PeakFlow.A_.value = ''}
  if (document.PeakFlow.L.value <= 0)   {document.PeakFlow.L.value = '';  document.PeakFlow.L_.value = ''}
  if (document.PeakFlow.Sg.value < 0)   {document.PeakFlow.Sg.value = ''; document.PeakFlow.Sg_.value = ''}
  if (document.PeakFlow.Sg.value > 100) {document.PeakFlow.Sg.value = ''; document.PeakFlow.Sg_.value = ''}
  if (document.PeakFlow.Tc.value < 0.1) {document.PeakFlow.Tc.value = ''; document.PeakFlow.Tc_.value = ''}
  if (document.PeakFlow.Tc.value > 10)  {document.PeakFlow.Tc.value = ''; document.PeakFlow.Tc_.value = ''}
  if (document.PeakFlow.CN.value < 15)  {document.PeakFlow.CN.value = ''; document.PeakFlow.CN_.value = ''}
  if (document.PeakFlow.CN.value > 100) {document.PeakFlow.CN.value = ''; document.PeakFlow.CN_.value = ''}
  if (document.PeakFlow.Fp.value < 0)   {document.PeakFlow.Fp.value = ''; document.PeakFlow.Fp_.value = ''}
  if (document.PeakFlow.Fp.value > 1)   {document.PeakFlow.Fp.value = ''; document.PeakFlow.Fp_.value = ''}
}

function Calculate_SI() {
   //transfer SI input values to US values
   //if all have values ...
   validate()
   var Q = document.PeakFlow.Q.value
   if (isNumber(Q)) {
     Q = Q / 25.4				// mm to in
     if (Q.toFixed(1)) Q=Q.toFixed(1)
     document.PeakFlow.Q_.value=Q
   }
   var P = document.PeakFlow.P.value
   if (isNumber(P)) {
     P = P / 25.4				// mm to in
     if (fixed) P=P.toFixed(1)
     document.PeakFlow.P_.value=P
   }
   var A = document.PeakFlow.A.value
   if (isNumber(A)) {
     A = A * 2.471				// ha to ac
     if (fixed) A=A.toFixed(1)
     document.PeakFlow.A_.value=A
   }
   var L = document.PeakFlow.L.value
   if (isNumber(L)) {
     L = L * 3.29				// m to ft
     if (fixed) L=L.toFixed(1)
     document.PeakFlow.L_.value=L
   }
   document.PeakFlow.Sg_.value = document.PeakFlow.Sg.value
   document.PeakFlow.Tc_.value = document.PeakFlow.Tc.value
   document.PeakFlow.CN_.value = document.PeakFlow.CN.value
   document.PeakFlow.Fp_.value = document.PeakFlow.Fp.value

   Calc_Tc()
   Estimate_CN()
   Estimate_SurfaceStorage()
   Estimate_RainfallFraction()
   Estimate_qu()
   Calc_q()

   //transfer SI results to US values

   document.PeakFlow.CN_.value = document.PeakFlow.CN.value
   var S = document.PeakFlow.S.value
   if (isNumber(S)) {
     S = S / 25.4				// mm to in
     if (fixed) S=S.toFixed(2)
     document.PeakFlow.S_.value=S
   }
   var Ia = document.PeakFlow.Ia.value
   if (isNumber(Ia)) {
     Ia = Ia / 25.4				// mm to in
     if (fixed) Ia=Ia.toFixed(2)
     document.PeakFlow.Ia_.value=Ia
   }
   document.PeakFlow.IaOnP_.value = document.PeakFlow.IaOnP.value
   var qu = document.PeakFlow.qu.value
   if (isNumber(qu)) {
     qu = qu / 35.31 * 2.471 / 25.4		// 1 m^3 per 35.31 ft^3, 1 ha per 2.471 ac, 25.4 mm per in
     if (fixed) qu=qu.toFixed(4)
     document.PeakFlow.qu_.value=qu
   }
   var q = document.PeakFlow.q.value
   if (isNumber(q)) {
     q = q * 35.31				// cubic meters per second to cubic feet per second
     if (fixed) q=q.toFixed(2)
     document.PeakFlow.q_.value=q
   }
}

function Calculate_US() {
   //transfer US input values to SI values
   //if all have values ...
   var Q_ = document.PeakFlow.Q_.value
   if (isNumber(Q_)) {
     Q_ = Q_ * 25.4				// in to mm
     if (fixed) Q_=Q_.toFixed(1)
     document.PeakFlow.Q.value=Q_
   }
   var P_ = document.PeakFlow.P_.value
   if (isNumber(P_)) {
     P_ = P_ * 25.4				// in to mm
     if (fixed) P_=P_.toFixed(1)
     document.PeakFlow.P.value=P_
   }
   var A_ = document.PeakFlow.A_.value
   if (isNumber(A_)) {
     A_ = A_ / 2.471				// ac to ha
     if (fixed) A_=A_.toFixed(1)
     document.PeakFlow.A.value=A_
   }
   var L_ = document.PeakFlow.L_.value
   if (isNumber(L_)) {
     L_ = L_ / 3.29				// ft to m
     if (fixed) L_=L_.toFixed(1)
     document.PeakFlow.L.value=L_
   }
   document.PeakFlow.Sg.value = document.PeakFlow.Sg_.value
   document.PeakFlow.Tc.value = document.PeakFlow.Tc_.value
   document.PeakFlow.CN.value = document.PeakFlow.CN_.value
   document.PeakFlow.Fp.value = document.PeakFlow.Fp_.value

   Calc_Tc()
   Estimate_CN()
   Estimate_SurfaceStorage()
   Estimate_RainfallFraction()
   Estimate_qu()
   Calc_q()

   //transfer SI results to US values

   document.PeakFlow.CN_.value = document.PeakFlow.CN.value
   var S = document.PeakFlow.S.value
   if (isNumber(S)) {
     S = S / 25.4				// mm to in
     if (fixed) S=S.toFixed(2)
     document.PeakFlow.S_.value=S
   }
   var Ia = document.PeakFlow.Ia.value
   if (isNumber(Ia)) {
     Ia = Ia / 25.4				// mm to in
     if (fixed) Ia=Ia.toFixed(2)
     document.PeakFlow.Ia_.value=Ia
   }
   document.PeakFlow.IaOnP_.value = document.PeakFlow.IaOnP.value
   var qu = document.PeakFlow.qu.value
   if (isNumber(qu)) {
     qu = qu / 35.31 * 2.471 / 25.4		// 1 m^3 per 35.31 ft^3, 1 ha per 2.471 ac, 25.4 mm per in 
     if (fixed) qu=qu.toFixed(4)
     document.PeakFlow.qu_.value=qu
   }
   var q = document.PeakFlow.q.value
   if (isNumber(q)) {
     q = q * 35.31				// cubic meters per second to cubic feet per second
     if (fixed) q=q.toFixed(2)
     document.PeakFlow.q_.value=q
   }
}

function ClearResults() {
   document.PeakFlow.S.value = ''
   document.PeakFlow.S_.value = ''
   document.PeakFlow.Ia.value = ''
   document.PeakFlow.Ia_.value = ''
   document.PeakFlow.IaOnP.value = ''
   document.PeakFlow.IaOnP_.value = ''
   document.PeakFlow.qu.value = ''
   document.PeakFlow.qu_.value = ''
   document.PeakFlow.q.value = ''
   document.PeakFlow.q_.value = ''
}

function Calc_Tc() {
  var Sg = document.PeakFlow.Sg.value		// Sg = average watershed gradient (m/m)
  var CN = document.PeakFlow.CN.value		// CN = runoff curve number
  var L  = document.PeakFlow.L.value		//  L = longest flow length (m)
  if (isNumber(Sg) && isNumber(CN) && isNumber(L)) {
    var num = Math.pow((1000/CN)-9,0.7)
    var den = 4407 * Math.pow(Sg,0.5)
    Tc = Math.pow(L,0.8) * num / den		// calculate Tc time of concentration (h) from equation 5.12
  }
  else {
    Tc = ''
    ClearResults()
  }
  document.PeakFlow.Tcag.value = Tc		//  alert(Tc)
  if (isNumber(Tc) && Tc.toFixed(2)) {
    document.PeakFlow.Tcag.value = Tc.toFixed(2)
  }
  else {}
}

function Estimate_SurfaceStorage() {
  var CN = document.PeakFlow.CN.value		// CN = runoff curve number
  document.PeakFlow.S.value = ''
  document.PeakFlow.Ia.value = ''    
  if (isNumber(CN)) {
    S  = (25400/CN)-254				// S  = Surface storage
    Ia = 0.2 * S
    document.PeakFlow.S.value = S		// alert (S)
    document.PeakFlow.Ia.value = Ia
    if (isNumber(S) && fixed) {
      document.PeakFlow.S.value = S.toFixed(0)
    }
    if (isNumber(Ia) && fixed) {
      document.PeakFlow.Ia.value = Ia.toFixed(1)
    }
  }
  else {
    ClearResults()
  }
}

function Estimate_CN() {			// From Iowa Stormwater Management Manual 2C-5 NRCS TR-55 Methodology
  var Q = document.PeakFlow.Q.value		// Q = runoff depth from a 24-h storm of the desired period (mm)
  var P = document.PeakFlow.P.value 		// P  = 24-h rainfall with a return period equal to the return period of the peak flow (mm)
  var CN = ''
  document.PeakFlow.CNforest.value = ''
  if (isNumber(Q) && isNumber(P)) {
    CN = 25400/((0.4*P+0.8*Q-Math.pow(Math.pow(0.4*P+0.8*Q,2)-0.16*(P*P-Q*P),0.5))/0.08+254)
    document.PeakFlow.CNforest.value = CN 
    if (isNumber(CN) && fixed) {
      document.PeakFlow.CNforest.value = CN.toFixed(0)
    }
  }
  else {
    ClearResults()
  }
}

function Estimate_RainfallFraction() {
  var Ia = document.PeakFlow.Ia.value		// Ia = runoff curve number
  var P  = document.PeakFlow.P.value 		// P  = 24-h rainfall with a return period equal to the return period of the peak flow
  IaOnP=''
  if (isNumber(Ia) && isNumber(P)) {
    IaOnP = Ia/P
    document.PeakFlow.IaOnP.value = IaOnP		// alert (IaOnP)
    if (isNumber(IaOnP) && fixed) {
      document.PeakFlow.IaOnP.value = IaOnP.toFixed(2)
    }
  }
  else {
    ClearResults()
  }
}

function Estimate_qu() {			// From figure 5.4
  var tc  = document.PeakFlow.Tc.value
  var iap = document.PeakFlow.IaOnP.value

// use upper and lower curve on Ia/P instead of dropping off   2010.07.15

  qu = ''
  if (isNumber(tc) && isNumber(iap)) {
    if (tc < .1) {qu=''}
    else if (tc <= .2) {
//      if (iap < .10) {}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.1,.2,4.60,4.10,3.44,3.00)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.1,.2,4.10,3.80,3.00,2.28)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.1,.2,3.80,3.50,2.28,2.47)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.1,.2,3.50,3.00,2.47,2.90)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.1,.2,3.00,2.28,2.90,1.60)}
      else {qu=twodinterp(iap,tc,.45,.50,.1,.2,3.00,2.28,2.90,1.60)}
    }
    else if (tc <= .4) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.2,.4,3.44,3.00,2.55,2.10)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.2,.4,3.00,2.82,2.10,1.88)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.2,.4,2.82,2.47,1.88,1.70)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.2,.4,2.47,2.90,1.70,1.42)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.2,.4,2.90,1.60,1.42,1.15)}
      else {qu=twodinterp(iap,tc,.45,.50,.2,.4,2.90,1.60,1.42,1.15)}
    }
    else if (tc <= .6) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.4,.6,2.55,2.10,1.95,1.67)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.4,.6,2.10,1.88,1.67,1.51)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.4,.6,1.88,1.70,1.51,1.38)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.4,.6,1.70,1.42,1.38,1.15)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.4,.6,1.42,1.15,1.15,0.95)}
      else {qu=twodinterp(iap,tc,.45,.50,.4,.6,1.42,1.15,1.15,0.95)}
    }
    else if (tc <= .8) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.6,.8,1.95,1.67,1.70,1.49)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.6,.8,1.67,1.51,1.49,1.33)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.6,.8,1.51,1.38,1.33,1.19)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.6,.8,1.38,1.15,1.19,0.98)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.6,.8,1.15,0.95,0.98,0.79)}
      else {qu=twodinterp(iap,tc,.45,.50,.6,.8,1.15,0.95,0.98,0.79)}
    }
    else if (tc <= 1) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,.8,1,1.70,1.49,1.50,1.35)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,.8,1,1.49,1.33,1.35,1.20)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,.8,1,1.33,1.19,1.20,1.03)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,.8,1,1.19,0.98,1.03,0.88)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,.8,1,0.98,0.79,0.88,0.70)}
      else {qu=twodinterp(iap,tc,.45,.50,.8,1,0.98,0.79,0.88,0.70)}
    }
    else if (tc <= 2) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,1,2,1.50,1.35,1.00,0.80)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,1,2,1.35,1.20,0.80,0.75)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,1,2,1.20,1.03,0.75,0.66)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,1,2,1.03,0.88,0.66,0.56)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,1,2,0.88,0.70,0.56,0.48)}
      else {qu=twodinterp(iap,tc,.45,.50,1,2,0.88,0.70,0.56,0.48)}
    }
    else if (tc <= 4) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,2,4,1.00,0.80,0.58,0.47)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,2,4,0.80,0.75,0.47,0.45)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,2,4,0.75,0.66,0.45,0.43)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,2,4,0.66,0.56,0.43,0.38)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,2,4,0.56,0.48,0.38,0.35)}
      else {qu=twodinterp(iap,tc,.45,.50,2,4,0.56,0.48,0.38,0.35)}
    }
    else if (tc <= 6) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,4,6,0.58,0.47,0.42,0.36)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,4,6,0.47,0.45,0.36,0.35)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,4,6,0.45,0.425,0.35,0.33)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,4,6,0.425,0.38,0.33,0.30)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,4,6,0.38,0.35,0.30,0.28)}
      else {qu=twodinterp(iap,tc,.45,.50,4,6,0.38,0.35,0.30,0.28)}
    }
    else if (tc <= 8) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,6,8,0.42,0.36,0.325,0.28)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,6,8,0.36,0.35,0.28,0.27)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,6,8,0.35,0.33,0.27,0.26)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,6,8,0.33,0.30,0.26,0.25)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,6,8,0.30,0.28,0.25,0.24)}
      else {qu=twodinterp(iap,tc,.45,.50,6,8,0.30,0.28,0.25,0.24)}
    }
    else if (tc <= 10) {
//      if (iap < .10) {qu=''}
      if (iap <= .30) {qu=twodinterp(iap,tc,.10,.30,8,10,0.325,0.275,0.255,0.235)}
      else if (iap <= .35) {qu=twodinterp(iap,tc,.30,.35,8,10,0.275,0.27,0.235,0.23)}
      else if (iap <= .40) {qu=twodinterp(iap,tc,.35,.40,8,10,0.27,0.26,0.23,0.225)}
      else if (iap <= .45) {qu=twodinterp(iap,tc,.40,.45,8,10,0.26,0.25,0.225,0.22)}
      else if (iap <= .50) {qu=twodinterp(iap,tc,.45,.50,8,10,0.25,0.24,0.22,0.215)}
      else {qu=twodinterp(iap,tc,.45,.50,8,10,0.25,0.24,0.22,0.215)}
    }
    else {qu=''}		// if (tc <= 10) ...
  }
  else {
    ClearResults()
  }
  document.PeakFlow.qu.value = qu
  if (isNumber(qu) && qu.toFixed(2)) {
    document.PeakFlow.qu.value = qu.toFixed(2)
  }
  if (qu<0) {ClearResults(); document.PeakFlow.qu.value = ''}
}

function Calc_q() {
  var qu = document.PeakFlow.qu.value/1000	// qu = unit peak flow rate (cu m/s per ha per mm of runoff)
  var A  = document.PeakFlow.A.value		// A  = watershed area (ha)
  var Q  = document.PeakFlow.Q.value		// Q = runoff depth from a 24-h storm of the desired period (mm)
  var Fp = document.PeakFlow.Fp.value		// pond and swamp adjustment factor
//  var Fp = 1					// pond and swamp adjustment factor
  q = ''
  if (isNumber(qu) && isNumber(A) && isNumber(Q)) {
    q  = qu * A * Q * Fp			// peak runoff rate (cu m/s); equation 5.11
  }
  document.PeakFlow.q.value = q			// alert(q)
  if (isNumber(q) && q.toFixed(2)) {
    document.PeakFlow.q.value = q.toFixed(2)
  }
}

function twodinterp(x,y,xl,xh,yl,yh,zll,zlr,zul,zur) {
   var xrat = (x-xl)/(xh-xl)
   var yrat = (y-yl)/(yh-yl)
   var yyl  = zll+(zul-zll)*yrat
   var yyr  = zlr+(zur-zlr)*yrat
   var xx   = yyl+(yyr-yyl)*xrat
   return xx
}

function isNumber(inputVal) {		//From JavaScript Handbook (Goodman) p. 374.
  if (inputVal == '') {return false}
  oneDecimal = false
  inputStr = "" + (inputVal+0)
  for (var i = 0; i < inputStr.length; i++) {
    var oneChar = inputStr.charAt(i)
    if (i == 0 && oneChar == "-") {
      continue
    }
    if (oneChar == "." && !oneDecimal) {
      oneDecimal = true
      continue
    }
    if (oneChar < "0" || oneChar > "9") {
      return false
    }
  }
  return true
}

function example() {
  document.PeakFlow.desc.value='Severe wildfire in a watershed in the Mica Creek Experimental Forest, Northern Idaho'
  document.PeakFlow.Q.value=26.5
  document.PeakFlow.P.value=49.3
  document.PeakFlow.L.value=2572
  document.PeakFlow.A.value=575
  document.PeakFlow.Sg.value=0.133
  document.PeakFlow.Tc.value=10
  document.PeakFlow.CN.value=90
  document.PeakFlow.Fp.value=1
  Calculate_SI()
}

function referenceBubbler() {
      var referencebub = document.getElementById('referenceBubble');
      b = referencebub.style;
      var vis = b.display;
      if (b.display != 'none') {b.display='none'}
         else {b.display=''};
}

function methodBubbler() {
      var methodbub = document.getElementById('methodBubble');
      b = methodbub.style;
      var vis = b.display;
      if (b.display != 'none') {b.display='none'}
         else {b.display=''};
}

function CNbubbler() {
      var CNbub = document.getElementById('CNbubble');
      b = CNbub.style;
      var vis = b.display;
      if (b.display != 'none') {b.display='none'}
         else {b.display=''};
}

function CNbubbler2() {
      var CNbub = document.getElementById('CNbubble');
      b = CNbub.style;
      var vis = b.visibility;
      if (b.visibility == '') {b.visibility='hidden';b.height=0}
         else {b.visibility=''};
}

////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////
//
// function showBubble and subordinates
//   (hideBubble,
//   is_right_available, 
//   is_top_available,
//   is_bot_available,
//   is_left_available)
// are licensed under the terms of the GNU General Public License as published by the Free Software Foundation.
// e.g.
// http://www.milliondollarscript.com/trac/browser/branches/3.0/include/area_map_functions.php?rev=19
//
// These subroutines are free software; you can redistribute them and/or modify
//  them under the terms of the GNU General Public License as published by
//  the Free Software Foundation; either version 3 of the License, or (at your option) any later version.
//
////////////////////////////////////////////////////////////////////////

function hideBubble(e) {	// showBubble, hideBubble and allies used under a GNU license.
  var bubble = document.getElementById('bubble');
  b = bubble.style;
  b.visibility='hidden';
}

function is_right_available(box,e) {
  if ((box.clientWidth+e.clientX+h_padding)>=winWidth){
    return false; 	// not available
  }
  return true;
}

function is_top_available(box,e) {
  if ((e.clientY-box.clientHeight-v_padding) < 0){
    return false;
  }
  return true;
}

function is_bot_available(box,e) {
  if ((e.clientY+box.clientHeight+v_padding) > winHeight){
    return false;
  }
  return true;
}

function is_left_available(box,e) {
  if ((e.clientX-box.clientWidth-h_padding)<0){
    return false;
  }
  return true;
}

function  showBubble(e, str, area) {
  var relTarg;
  var bubble = document.getElementById('bubble');
  if (!e) var e = window.event;
  if (e.relatedTarget) relTarg = e.relatedTarget;
  else if (e.fromElement) relTarg = e.fromElement;

  var posRefX, posRefY = 0; 
  posRefX= ((e.pageX && !e.clientX) ? e.pageX : e.clientX + document.body.scrollLeft);
  posRefY= ((e.pageY && !e.clientY) ? e.pagey : e.clientY + document.body.scrollTop);

  b = bubble.style

  document.getElementById('bubble').innerHTML=str;

  var mytop   = is_top_available(bubble,e);
  var mybot   = is_bot_available(bubble, e);
  var myright = is_right_available(bubble,e);
  var myleft  = is_left_available(bubble,e);
  if (mytop) {		 		 // move to the top
     bubble.ypos=posRefY-bubble.clientHeight-v_padding;
  }
  if (myright) {		  	// move to the right
    bubble.xpos=posRefX+h_padding;
  }
  if (myleft) {		 		 // move to the left
     bubble.xpos=posRefX-bubble.clientWidth-h_padding ;
  }
  if (mybot) {		 		 // move to the bottom
     bubble.ypos=posRefY+v_padding;
  }
   b.visibility='visible';
}
////////////////////////////////////////////////////////////////////////
   -->
  </script>
 </head>
 <body link=green vlink=green alink=crimson>
  <font face="comic sans, trebuchet, tahoma" size=-1>
   <table border=0 width=85%>
    <tr>
     <td><img src="peakflow.jpg" width=50 height=42 border=1></td>
     <th valign=bottom>
      <h4>Forest Service Peak Flow Calculator<br>Estimated peak flow for burned areas using Curve Number technology
      <br><font color=crimson>beta-test</font> version <script>document.writeln(version)</script>
</h4>
     </th>
    </tr>
   </table>

  <form name="PeakFlow">

   <table border=1 cellpadding=2>
    <tr>
     <td align=right bgcolor=lightblue
      onmouseover="showBubble(event,'', this)"><font face="comic sans, trebuchet, tahoma" size=-1>
      Run Description
     </td>
     <td colspan=4 bgcolor=lightblue>
      <input type=text name="desc" size=100>
     </font></td>
    </tr>
<!--      RUNOFF    -->
    <tr>
     <td align=right bgcolor=lightgreen
       onmouseover="showBubble(event,'<b>Storm runoff (from ERMiT run).</b> From the information given in the ERMiT <i>Rainfall Event Rankings and Characteristics From Selected Storms</i> table, it is possible to determine a number of attributes about the nature of the runoff.  This example is from an ERMiT run for a severe wildfire using a hillside in a watershed in the Mica Creek Experimental Forest in Northern Idaho. The largest predicted storm runoff event from 100 years of stochastic climate on a severely burned hillslope was 88&nbsp;mm from only 10.1&nbsp;mm of precipitation on March&nbsp;1 in year&nbsp;97. As the runoff is greater than the precipitation, and it occurred in March, the user can assume that this was a rain-on-snow event, and a melting snowpack contributed more water to the runoff than was in the rainfall.<br><br>If it is likely that the runoff event of concern occurred during a time when the soil was likely saturated, as it is during most rain-on-snow or snow-melt events, the user may want to increase the runoff amount to account for lateral flow.  This can be estimated from the WEPP Windows water file for a run for the same climate and hillslope, with specifying a soil and cover to match the fire severity condition, and noting the lateral flow on the date of concern.<br><br>Another approach is simply to increase the runoff amount by about 20 percent, a typical average value in a burned watershed.<br><br><img src=ERMiTexampleRun.gif>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1><a title="(from ERMiT)">Storm runoff,</a> <b>Q</b>&nbsp;</font></td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1><input type=text size=10 name=Q value='' onchange="Calculate_SI()">
     &nbsp;mm</font></td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Q_ value='' onchange="Calculate_US()">
     &nbsp;in</font></td>
    </tr>
<!--      24-HOUR RAINFALL    -->
    <tr>
     <td align=right bgcolor=lightgreen
       onmouseover="showBubble(event,'<b>Storm precipitation</b> from ERMiT run. Use ERMiT storm amount as a surrogate for 24-h rainfall. The precipitation value is often chosen to be a 6-hr or 24-hr design storm that occurs once every 10 or 20 years. If the runoff is from snowmelt, so that the runoff is greater than the precipitation, then it is recommended that a value for precipitation about twice the runoff amount be entered in the precipitation line.', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1><a title="(from ERMiT)">Storm precipitation,</a> <b>P</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=P size=10 value='' onchange="Calculate_SI()">
     &nbsp;mm</font></td>
     <td colspan=2 bgcolor=lightgreen><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=P_ value='' onchange="Calculate_US()">
     &nbsp;in       &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if Q &gt; P use P ~ 2 Q&nbsp; </font></td>
    </tr>
<!--      WATERSHED UPPER AREA    -->
    <tr>
     <td align=right bgcolor=lightblue
      onmouseover="showBubble(event,'<b>Watershed area</b> above the structure of interest or watershed outlet. In the TR-55 method employed in this estimator, the peak flow rate is in direct proportion to the watershed area.  Area can be estimated from maps with a planimeter or grid method.  There are numerous GIS methods for estimating watershed area.  The GeoWEPP ArcGIS wizard may be particularly beneficial because it can supplement the analysis procedure by estimating watershed area, provide sets of slope length and steepness values to enter into the ERMiT tool when used with the RMRS GeoWEPPer tool, or provide return period estimates of runoff that include lateral flow to use directly with the peak flow estimator.', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Watershed area, <b>A</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=A size=10 value='' onchange="Calculate_SI()">
      &nbsp;ha</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=A_ value='' onchange="Calculate_US()">
     &nbsp;ac</font></td>
    </tr>
<!--      WATERSHED LENGTH    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'<b>Watershed flow length</b> is the horizontal distance from the top of the watershed to the structure or watershed outlet of interest.  This distance should follow the flow path, and will not necessarily be a straight line.  A GIS or a ruler and a scaled map will provide this estimate.<br><br>L ~ 110 * A<sup>0.6</sup> for small watersheds  (L in m, A in ha)', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>
        Watershed flow length, <b>L</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=L size=10 value='' onchange="Calculate_SI()">
      &nbsp;m</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=L_ value='' onchange="Calculate_US()">
     &nbsp;ft</font></td>
    </tr>
<!--      AVERAGE WATERSHED GRADIENT    -->
    <tr>
     <td align=right bgcolor=lightblue
      onmouseover="showBubble(event,'<b>Average watershed gradient</b> can be estimated by dividing the difference in elevation at the top of the watershed and the elevation of the structure or watershed outlet of interest by the distance between the two.<br><br>The average steepness of a watershed is estimated by measuring the flow length <i>L</i> from the highest point in the watershed to the point of interest downstream.  Traditional mapping methods with a ruler or scale can be used, and a number of GIS methods are now available.  The difference between the elevation at the highest point in the watershed and the watershed outlet is divided by the flow length to estimate an average watershed gradient <i>Sg</i>.', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Avg watershed gradient, <b>Sg</b>&nbsp;</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=Sg size=10 value='' onchange="Calculate_SI()">
      &nbsp;m/m</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name='Sg_' value='' onchange="Calculate_US()">
     &nbsp;ft/ft</font></td>
    </tr>
<!--      CURVE NUMBER    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'The curve number is based on the runoff <i>Q</i> and precipitation <i>P</i> numbers entered above. One estimate (which is likely larger than that generally recommended for forests) for CN is<br><br>CN ~ 25400/([0.4*P+0.8*Q-([0.4*P+0.8*Q]<sup>2</sup>-0.16*[P*P-Q*P])<sup>0.5</sup>]/0.08+254)  (P and Q in mm)<br><br>Further suggestions for Curve Numbers for forests are provided below.', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Curve number, <b>CN</b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue>
      <font face="comic sans, trebuchet, tahoma" size=-1>
       <input type=text name=CN size=10 value="" onchange="Calculate_SI()">
      </font>
      &nbsp;
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=CN_ value='' onchange="Calculate_US()">
      &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CN estimate from ERMiT: <input type=text size = 5 readonly name=CNforest onclick=TransferCN()> &nbsp;&nbsp;(forest)
     &nbsp;</font></td>
    </tr>
<!--      TIME OF CONCENTRATION    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'<b>Time of concentration, <i>T<sub>c</sub></i>.</b> The TR-55 approach estimates a property called the time of concentration for a watershed, the theoretical time it takes a drop of rainwater to travel from the top of the watershed to the watershed outlet.  It can be as little as ten minutes, to several hours, depending on the size of the watershed.  It is generally estimated with surface and channel velocity equations, or regression equations that are a function of watershed length and steepness.  Watersheds with longer times of concentration will have lower peak flow rates for the same amount of total runoff.<br><br>There are two options for this value. The default value is 10 hours, the maximum value that can be used in the regression equation to predict peak flow.  This is the recommended value unless the watershed has a gradient less than 0.01 m/m (ft/ft) so that lateral flow is minimal, or the climate is dominated by high intensity summer storms on dry soils as may occur in the Southwestern U.S.  For flat watersheds or high intensity storms on dry soils, a <i>T<sub>c</sub></i> value, shown in the right-hand column, is calculated by a regression equation (below) based on watershed length, slope steepness, and curve number (<i>CN</i>).<br><br>T<sub>c</sub> ~ (L<sup>0.8</sup>) * ([1000/CN]-9)<sup>0.7</sup> / (4407 * Sg<sup>0.5</sup>) h for flat watersheds or high intensity storms on dry soils (L in m)<br><br>Average watershed gradient can be used in a regression equation to estimate the time of concentration. There are numerous other methods for estimating the time of concentration.  One common method is to estimate the time it takes water to travel overland along the hillslope from the highest point in the watershed, and add to that the time it takes the water to travel through the stream network to the point of interest.', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Time of concentration, <b>T<sub>c</sub></b>&nbsp;</font>
     </td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=Tc size=10 value='10' onchange="Calculate_SI()">
       &nbsp;h</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Tc_ value='10' onchange="Calculate_US()">
     &nbsp;h&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;T<sub>c</sub> ~ <input type=text size = 5 readonly name=Tcag onclick=TransferTcag()> h (flat watershed; dry soil)</font></td>
    </tr>
<!--      PONDING FACTOR Fp    -->
    <tr>
     <td align=right bgcolor=lightblue
       onmouseover="showBubble(event,'The <b>ponding adjustment factor</b> is for standing water, bog, pond, or swamp. <table><tr><th><font size=1>Percentage of pond/<br>swamp area</th><th><font size=1><i>Fp</i></th></tr><tr><td><font size=1>0.0</td><td><font size=1>1.00</td></tr><tr><td><font size=1>0.2</td><td><font size=1>0.97</td></tr><tr><td><font size=1>1.0</td><td><font size=1>0.87</td></tr><tr><td><font size=1>3.0</td><td><font size=1>0.75</td></tr><tr><td><font size=1>5.0</td><td><font size=1>0.72</td></tr></table>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Ponding adjustment factor, <b>Fp</b>&nbsp;</font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name="Fp" size=10 value='1' onchange="Calculate_SI()"></font></td>
     <td colspan=2 bgcolor=lightblue><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Fp_ value=1 onchange="Calculate_US()">
     &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font size=-1>0% pond:&nbsp;1.0; 1.0%:&nbsp;0.87; 5.0%:&nbsp;0.72</font></font></td>
    </tr>
<!--      RESULTS    -->
<!--      RESULTS    -->
    <tr>
     <th colspan=5 bgcolor="lightgrey"
      onmouseover="showBubble(event,'', this)"><font face="comic sans, trebuchet, tahoma" size=-1>RESULTS</th>
    </tr>
<!--      SURFACE STORAGE    -->
    <tr>
     <td align=right bgcolor="lightgrey"
       onmouseover="showBubble(event,'<b>Surface storage</b> <i>S</i> is the potential maximum retention after runoff begins. <i>S</i> is related to the soil and cover conditions of the watershed through the CN. CN has a range of 0 to 100, and S is related to CN by:<br><br>S ~ (25400/CN)-254 &nbsp;&nbsp;&nbsp;(S in mm)<br><br>[ISU 2008 p. 3]', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Surface storage, <b>S</b>&nbsp;</font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=S size=10 value='' readonly>
       &nbsp;mm</font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=S_ value='' onchange="Calculate_SI()" readonly>
     &nbsp;in</font></td>
    </tr>
<!--      INITIAL ABSTRACTION    -->
    <tr>
     <td align=right bgcolor="lightgrey"
       onmouseover="showBubble(event,'Initial abstraction (<i>I<sub>a</sub></i>) is all losses before runoff begins. It includes water retained in surface depressions, water intercepted by vegetation, evaporation, and infiltration. <i>I<sub>a</sub></i> is highly variable but generally is correlated with soil and cover parameters. Through studies of many small agricultural watersheds, <i>I<sub>a</sub></i> was found to be approximated by the following empirical equation:<br><br>I<sub>a</sub> = 0.2 * S<br><br>[ISU 2008]', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Initial abstraction, <b>I<sub>a</sub></b>&nbsp;</font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=Ia size=10 value='' readonly>
      &nbsp;mm</font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=Ia_ value='' onchange="Calculate_US()" readonly>
     &nbsp;in</font></td>
    </tr>
<!--      Ia/P    -->
    <tr>
     <td align=right bgcolor="lightgrey"
       onmouseover="showBubble(event,'<b>I<sub>a</sub>/P</b> is the ratio of the initial abstraction, <i>I<sub>a</sub></i>, to precipitation <i>P</i>. A mathematical interpolation routine has been developed to estimate unit peak flow rate <i>q<sub>u</sub></i> from time of concentration <i>T<sub>c</sub></i> and <i>I<sub>a</sub>/P</i>.', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1><b>I<sub>a</sub>/P</b>&nbsp;</font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name="IaOnP" size=10 value='' readonly></font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=IaOnP_ value='' onchange="Calculate_SI()" readonly>
     &nbsp;</font></td>
    </tr>
<!--      UNIT PEAK FLOW RATE    -->
    <tr>
     <td align=right bgcolor="lightgrey"
       onmouseover="showBubble(event,'The unit peak flow rate <i>q<sub>u</sub></i> is estimated from the time of concentration <i>T<sub>c</sub></i> and the ratio of the initial abstraction <i>I<sub>a</sub></i> to the precipitation amount <i>P</i>. <i>q<sub>u</sub></i> can be obtained from the graph below.<br><br>q<sub>u</sub> = f(T<sub>c</sub>, I<sub>a</sub>/P); 0.1 &lt;= I<sub>a</sub>/P &lt;= 0.5; 0.1 &lt;= T<sub>c</sub> &lt;= 10<br><br><img src=fangmeier.gif title=Fangmeier_2006><br><br>The SCS developed four dimensionless 24-hour rainfall distributions &ndash; type I, IA, II, and III &ndash; from the available NWS duration-frequency data to represent various regions of U.S.<br>Types I and IA represent the Pacific maritime climates with wet winters and dry summers.<br>Type III represents Gulf of Mexico and Atlantic coastal areas where tropical storms result in large 24-hour rainfall.<br>Type II represents the rest of the U.S. (USDA SCS, 1986).<!-- 6728.pdf --><br><br><img src=stormtypes.gif title=Iowa_2008>', this)">
       <font face="comic sans, trebuchet, tahoma" size=-1>Unit peak flow rate, <b>q<sub>u</sub></b>&nbsp;</font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=qu size=10 value='' readonly>
       &nbsp;m<sup>3</sup>/s per ha-mm x 10<sup>-3</sup></font></td>
     <td colspan=2 bgcolor="lightgrey"><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=qu_ value='' onchange="Calculate_US()" readonly>
      &nbsp;ft<sup>3</sup>/s per acre-in x 10<sup>-3</sup></font></td>
    </tr>
<!--      ESTIMATED PEAK FLOW    -->
    <tr>
     <td align=right bgcolor=gold
       onmouseover="showBubble(event,'The <b>estimated peak flow rate</b> is the product of the unit peak flow rate, watershed area, runoff depth, and a ponding adjustment factor.  This value is intended to be used as a guide when estimating peak discharge or designing structures in channels downstream from areas of forested watersheds that have been burned.<br><br>q = q<sub>u</sub> * A * Q * Fp', this)">
      <font face="comic sans, trebuchet, tahoma" size=-1>Estimated peak flow rate, <b>q</b>&nbsp;</font>
     </td>
     <td bgcolor=gold><font face="comic sans, trebuchet, tahoma" size=-1><input type=text name=q size=10 value='' readonly>
       &nbsp;m<sup>3</sup>/s</font></td>
     <td align=right bgcolor=lightgreen><a onClick="Calculate_SI()"><img src="go.gif"></a></td>
     <td colspan=2 bgcolor=gold><font face="comic sans, trebuchet, tahoma" size=-1>
      <input type=text size=10 name=q_ value='' onchange="Calculate_US()" readonly>
      &nbsp;ft<sup>3</sup>/s</font></td>
    </tr>
   </table>
   <font size=1>use <a href="javascript:example()">Mica Creek example</a>&nbsp;|&nbsp;<a href="javascript:document.forms.PeakFlow.reset()">clear</a>

   <blockquote>
    <span id="bubble"></span>
   </blockquote>
  </form>

   <font size=-1>

   <b><a href="javascript:CNbubbler()">&nabla;</a> Curve Numbers for Forests</b>
   <span id="CNbubble" Style="display:none">
<blockquote>
<table border=1 width=75%>
 <tr>
  <th colspan=3><font size=-1>Hydrologic condition</font></th>
  <th rowspan=2><font size=-1>Hydrologic soil condition</font></th>
 </tr>
 <tr><th><font size=-1>Poor</font></th><th><font size=-1>Fair</font></th><th><font size=-1>Good</font></th></tr>
 <tr>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=45" title="click to transfer">45</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=36" title="click to transfer">36</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=30" title="click to transfer">30</a></font></th>
  <td><font size=-1><b>Soils have a low runoff potential</b> due to high infiltration rates. These soils consist primarily of deep, well-drained sands and gravels</font></td>
 </tr>
 <tr>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=66" title="click to transfer">66</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=60" title="click to transfer">60</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=55" title="click to transfer">55</a></font></th>
  <td><font size=-1><b>Soils have a moderately low runoff potential</b> due to moderate infiltration rates. These soils consist primarily of moderately deep to deep, moderately well- to well-drained soils with moderately fine to moderately coarse textures.</font></td>
 </tr>
 <tr>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=77" title="click to transfer">77</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=73" title="click to transfer">73</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=70" title="click to transfer">70</a></font></th>
  <td><font size=-1><b>Soils have a moderately high runoff potential</b> due to slow infiltration rates. These soils consist primarily of soils in which a layer exists near the surface that impedes the downward movement of water or soils with moderately fine to fine texture.</font></td>
 </tr>
 <tr>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=83" title="click to transfer">83</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=79" title="click to transfer">79</a></font></th>
  <th><font size=-1><a onClick="javascript:document.PeakFlow.CN.value=77" title="click to transfer">77</a></font></th>
  <td><font size=-1><b>Soils have a high runoff potential</b> due to very slow infiltration rates. These soils consist primarily of clays with high swelling potential, soils with permanently high water tables, soils with a clay pan or clay layer at or near the surface, and shallow soils over nearly impervious parent material.</font></td>
 </tr>
 <tr>
  <td colspan=4>
   <font size=-1>
    <b>Poor:</b> forest litter, small trees, and brush are destroyed by heavy grazing or regular burning.<br>
    <b>Fair:</b> forests are grazed, but not burned, and some forest litter covers the soil.<br>
    <b>Good:</b> forests are protected from grazing, and litter and brush adequately cover the soil.
   </font>
   <br><br>
   <font size=-2>
    Modified from: ISU 2008, Table 4, p.&nbsp;9.
   </font>
  </td>
 </tr>
</table>
</blockquote>
  </span>

<!-- 
***   Need to define or recommend which storm rank event to use -- "1" or "5" (20-year return).<br>
*** X Need to cite bubble source<br>
***   Logo
***   Doc link<br>
***   CN guidance (tables, equations, ...)<br>
***   Watershed gradient help is repetitive<br>
***   Link from ERMiT?<br>
-->

 <br><br>
<b><a href="javascript:methodBubbler()">&nabla;</a> Method</b>
 <br><br>
<span id='methodBubble' style="display:none">
 <blockquote>
 To predict peak runoff from total storm runoff:
 <ol>
  <li>Run ERMiT for climate and hillslope typical of the watershed.</li>
  <li>Note the return period runoff volume from first ERMiT table (Rainfall Event Rankings and Characteristics From Selected Storms).</li>
  <li>Estimate the peak runoff rate from the runoff volume using the TR-55 method.</li>
 </ol>

 Changing the length and steepness of the hillslope is unlikely to change the predicted runoff amount.
 It will make a bit of difference in erosion.
 <br><br>
 The SCS-TR55 method has been widely used to estimate peak runoff rates from small rural and urban watersheds (SCS, 1986).
 This method of estimating peak runoff rate is applicable to watersheds that are smaller than 900 ha and
 with average slopes greater than 0.5 percent with one main channel or two tributaries with nearly the same
 time of concentration. 
 (Fangmeier et al., 2006. 5.16-TR55 Method For Estimating Peak Runoff Rate.)
 <br><br>
 </blockquote>
</span>

<b><a href="javascript:referenceBubbler()">&nabla;</a> References</b>
<br><br>
<span id='referenceBubble' style="display:none">
<blockquote>
<p class="Reference">
 Fangmeier, D.D.; Elliot, W.J.; Workman, S.R.; Huffman, R.L.; Schwab, G.O. 2006.
 <b>Soil and Water Conservation Engineering,</b> Fifth Edition.
 Clifton Park, NJ: Thompson Delmar Learning. 95-97.
</p>
<p class="Reference">
 Foltz, R.B.; Robichaud, P.R.; Rhee, H. 2009. <b>Post-Fire Peak Flow and Erosion Estimation;</b>
 <b>Use of Post-Fire CNs by BAER Specialists.</b>
 Moscow, ID: USDA Forest Service, Rocky Mountain Research Station.
 Web page. Last Modified 05/13/2009.
 <a href="http://forest.moscowfsl.wsu.edu/BAERTOOLS/ROADTRT/Peakflow/CN/supplement.html#CNGuideline" target="_ref">forest.moscowfsl.wsu.edu/BAERTOOLS/ROADTRT/Peakflow/CN/supplement.html#CNGuideline</a>
</p>
<p class="Reference">
 Iowa State University, 2008.
 <b>Iowa Stormwater Management Manual. Version 2.</b> Chapter 2C.5, NRCS TR-55 Methodology.
 Iowa State University.
 <a href="http://www.ctre.iastate.edu/PUBS/stormwater/documents/2C-5NRCSTR-55Methodology.pdf" target="_ref">www.ctre.iastate.edu/PUBS/stormwater/documents/2C-5NRCSTR-55Methodology.pdf</a>
</p>
<p class="Reference">
 Soil Conservation Service, 1986. <b>Urban Hydrology for Small Watersheds.</b>
 USDA Natural Resources Conservation Service, Conservation Engineering Division, Technical Release 55. June 1986. 164&nbsp;p.
 <a href="http://www.cpesc.org/reference/tr55.pdf" target="_ref">www.cpesc.org/reference/tr55.pdf</a>
</p>
 </blockquote>
</span>

</font>
<hr>
Citation:<br>
Elliot, William J.; Hall, David E.; Robichaud, Peter R. 2010. <b>FS Peak Flow Calculator.</b> Ver.
<script>
   document.writeln('<a href="javascript:popuphistory()">'+version+'</a>.')
</script>
Moscow, ID: U.S. Department of Agriculture, Forest Service, Rocky Mountain Research Station. 
Online at &lt;http://forest.moscowfsl.wsu.edu/fswepp/ermit/peakflow&gt;.
   </font>
  </font>
 </body>
</html>
